<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Inventory Manager V3</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* Color Palette */
            --bg-dark: #0f172a;
            --surface-card: #1e293b;
            --surface-hover: #334155;
            --primary: #3b82f6;
            --primary-glow: rgba(59, 130, 246, 0.5);
            --accent: #06b6d4;
            --text-main: #f1f5f9;
            --text-sub: #94a3b8;
            --danger: #ef4444;
            --success: #10b981;
            
            /* Typography Variables */
            --font-pc-header: 1.4rem;
            --font-pc-cell: 1.1rem;
            --font-mobile-title: 1.2rem;
            --font-mobile-text: 0.95rem;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* =========================================
           TOP NAVIGATION BAR
           ========================================= */
        nav {
            background: rgba(30, 41, 59, 0.9);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #334155;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .brand h1 {
            font-size: 1.8rem;
            background: linear-gradient(135deg, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 1px;
        }

        /* Settings Gear Animation */
        .settings-btn {
            background: none;
            border: none;
            color: var(--text-sub);
            font-size: 1.8rem;
            cursor: pointer;
            transition: color 0.3s;
        }

        .settings-btn:hover { color: var(--accent); }
        
        .rotate-icon { animation: spin 3s linear infinite; }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* =========================================
           CONTROLS SECTION
           ========================================= */
        .controls-wrapper {
            padding: 2rem 2rem 1rem 2rem;
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex-grow: 1;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            background: var(--surface-card);
            border: 1px solid #334155;
            color: white;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 15px var(--primary-glow);
            outline: none;
        }

        .search-box i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-sub);
        }

        .btn-group {
            display: flex;
            gap: 1rem;
        }

        button.btn-main {
            background: linear-gradient(135deg, var(--primary), #2563eb);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        button.btn-main:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(37, 99, 235, 0.4);
        }

        /* =========================================
           PC LAYOUT (Table View)
           ========================================= */
        .pc-view {
            padding: 0 2rem 2rem 2rem;
            animation: slideUp 0.6s ease-out;
            display: block; /* Default to PC */
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 10px; /* Space between rows */
        }

        thead th {
            text-align: left;
            padding: 1.5rem;
            font-size: var(--font-pc-header);
            color: var(--text-main);
            text-transform: uppercase;
            letter-spacing: 1.2px;
            border-bottom: 2px solid var(--accent);
            font-weight: 800; /* Big and Bold */
        }

        tbody tr {
            background: var(--surface-card);
            transition: transform 0.2s, background 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        tbody tr:hover {
            transform: scale(1.01);
            background: var(--surface-hover);
            z-index: 10;
            position: relative;
        }

        tbody td {
            padding: 1.5rem;
            font-size: var(--font-pc-cell);
            border-top: 1px solid #334155;
            border-bottom: 1px solid #334155;
        }

        tbody tr td:first-child { border-left: 1px solid #334155; border-top-left-radius: 10px; border-bottom-left-radius: 10px; }
        tbody tr td:last-child { border-right: 1px solid #334155; border-top-right-radius: 10px; border-bottom-right-radius: 10px; }

        /* =========================================
           MOBILE LAYOUT (Card View)
           ========================================= */
        .mobile-view {
            display: none; /* Hidden on PC */
            padding: 1rem;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .inventory-card {
            background: var(--surface-card);
            padding: 1.2rem;
            border-radius: 12px;
            border: 1px solid #334155;
            position: relative;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            animation: fadeIn 0.5s;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 10px;
        }

        .card-title {
            font-size: var(--font-mobile-title);
            font-weight: bold;
            color: var(--accent);
        }

        .card-spec {
            font-size: 0.9rem;
            color: var(--text-sub);
            margin-bottom: 10px;
        }

        .card-details {
            display: flex;
            justify-content: space-between;
            background: rgba(0,0,0,0.2);
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 10px;
            font-size: var(--font-mobile-text);
        }

        /* =========================================
           RESPONSIVE SWITCHER
           ========================================= */
        @media screen and (max-width: 900px) {
            .pc-view { display: none; }
            .mobile-view { display: grid; }
            
            nav { padding: 1rem; flex-direction: column; gap: 1rem; }
            .controls-wrapper { padding: 1rem; }
            .search-box input { width: 100%; }
            .brand h1 { font-size: 1.5rem; }
            
            /* Mobile Buttons become icon-only or stacked */
            .btn-group { width: 100%; justify-content: space-between; }
            .btn-main { padding: 0.6rem 1rem; font-size: 0.9rem; }
        }

        /* =========================================
           MODALS & ANIMATIONS
           ========================================= */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
            z-index: 100;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .modal-overlay.active { opacity: 1; pointer-events: all; }

        .modal-box {
            background: var(--surface-card);
            width: 90%; max-width: 500px;
            padding: 2rem;
            border-radius: 16px;
            border: 1px solid var(--primary);
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.2);
            transform: translateY(50px); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-overlay.active .modal-box { transform: translateY(0); }

        .form-label { display: block; margin-bottom: 8px; color: var(--accent); font-weight: 600; }
        .form-input { width: 100%; padding: 12px; background: #0f172a; border: 1px solid #334155; color: white; border-radius: 6px; margin-bottom: 15px; }
        
        /* Utility Classes */
        .tag { padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.85rem; }
        .tag-low { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .tag-ok { background: rgba(16, 185, 129, 0.2); color: var(--success); }

        .btn-icon { background: none; border: none; cursor: pointer; color: var(--text-sub); font-size: 1.1rem; padding: 5px; }
        .btn-icon:hover { color: white; transform: scale(1.2); }

        @keyframes slideUp { from { transform: translateY(30px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    </style>
</head>
<body>

    <nav>
        <div class="brand">
            <i class="fa-solid fa-microchip fa-2x" style="color: var(--primary);"></i>
            <div>
                <h1>ElectroInv <span style="font-size: 0.5em; vertical-align: super; color: var(--accent);">PRO</span></h1>
            </div>
        </div>
        <button class="settings-btn" id="settingsTrigger" onclick="openModal('settingsModal')">
            <i class="fa-solid fa-gear" id="gearIcon"></i>
        </button>
    </nav>

    <div class="controls-wrapper">
        <div class="search-box">
            <i class="fa-solid fa-magnifying-glass"></i>
            <input type="text" id="searchInput" placeholder="Search Component, Spec, or Storage ID..." onkeyup="handleSearch()">
        </div>
        <div class="btn-group">
            <button class="btn-main" onclick="openModal('addModal')">
                <i class="fa-solid fa-plus"></i> Add Item
            </button>
            <button class="btn-main" style="background: var(--surface-card); border: 1px solid #475569;" onclick="openHistory()">
                <i class="fa-solid fa-clock-rotate-left"></i> Logs
            </button>
        </div>
    </div>

    <div class="pc-view">
        <table>
            <thead>
                <tr>
                    <th>Component Name</th>
                    <th>Specification</th>
                    <th>Storage Location</th>
                    <th>Current Stock</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="pcTableBody">
                </tbody>
        </table>
    </div>

    <div class="mobile-view" id="mobileCardContainer">
        </div>

    <div class="modal-overlay" id="addModal">
        <div class="modal-box">
            <h2 style="margin-bottom: 20px; color: white;">Add New Component</h2>
            <form onsubmit="handleAddItem(event)">
                <label class="form-label">Component Name</label>
                <input type="text" class="form-input" id="inName" required placeholder="e.g. ESP32 Module">
                
                <label class="form-label">Specification / Model</label>
                <input type="text" class="form-input" id="inSpec" required placeholder="e.g. WROOM-32D">
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div>
                        <label class="form-label">Storage Loc</label>
                        <input type="text" class="form-input" id="inLoc" required placeholder="Box A1">
                    </div>
                    <div>
                        <label class="form-label">Quantity</label>
                        <input type="number" class="form-input" id="inStock" required min="0">
                    </div>
                </div>

                <div style="text-align: right; margin-top: 10px;">
                    <button type="button" class="btn-main" style="background: transparent; display: inline-flex;" onclick="closeModal('addModal')">Cancel</button>
                    <button type="submit" class="btn-main" style="display: inline-flex;">Save Component</button>
                </div>
            </form>
        </div>
    </div>

    <div class="modal-overlay" id="settingsModal">
        <div class="modal-box">
            <h2 style="margin-bottom: 20px; color: var(--text-main);"><i class="fa-solid fa-sliders"></i> System Configuration</h2>
            
            <label class="form-label">Remote Database URL (API)</label>
            <input type="text" class="form-input" id="apiUrl" placeholder="https://api.inventory.com/v1...">
            
            <label class="form-label">API Access Key</label>
            <input type="password" class="form-input" id="apiKey" placeholder="sk-...">
            
            <div style="margin-bottom: 20px; padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                <label class="form-label" style="display: flex; align-items: center; gap: 10px; margin: 0;">
                    <input type="checkbox" id="autoSync" checked> Auto-Sync Data on Change
                </label>
            </div>

            <div style="text-align: right;">
                <button class="btn-main" onclick="saveSettings()">Save Configuration</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="historyModal">
        <div class="modal-box" style="max-height: 80vh; overflow-y: auto;">
            <h2 style="margin-bottom: 15px;">Operation Logs</h2>
            <ul id="logList" style="list-style: none; padding-left: 0;"></ul>
            <button class="btn-main" style="width: 100%; justify-content: center; margin-top: 15px;" onclick="closeModal('historyModal')">Close</button>
        </div>
    </div>

    <script>
        // === STATE MANAGEMENT ===
        let inventory = JSON.parse(localStorage.getItem('electro_inventory')) || [];
        let logs = JSON.parse(localStorage.getItem('electro_logs')) || [];
        let config = JSON.parse(localStorage.getItem('electro_config')) || { apiUrl: '', apiKey: '', autoSync: true };

        // === INITIALIZATION ===
        document.addEventListener('DOMContentLoaded', () => {
            refreshUI();
            
            // Load Settings into Inputs
            document.getElementById('apiUrl').value = config.apiUrl;
            document.getElementById('apiKey').value = config.apiKey;
            document.getElementById('autoSync').checked = config.autoSync;

            // Hover effect for gear
            const gear = document.getElementById('settingsTrigger');
            gear.addEventListener('mouseenter', () => document.getElementById('gearIcon').classList.add('rotate-icon'));
            gear.addEventListener('mouseleave', () => document.getElementById('gearIcon').classList.remove('rotate-icon'));
        });

        // === CORE RENDERER (Dual Layout Logic) ===
        function refreshUI(data = inventory) {
            const pcBody = document.getElementById('pcTableBody');
            const mobileContainer = document.getElementById('mobileCardContainer');
            
            pcBody.innerHTML = '';
            mobileContainer.innerHTML = '';

            if(data.length === 0) {
                const emptyMsg = `<div style="text-align:center; padding:2rem; color:var(--text-sub);">No Data Found</div>`;
                pcBody.innerHTML = `<tr><td colspan="5">${emptyMsg}</td></tr>`;
                mobileContainer.innerHTML = emptyMsg;
                return;
            }

            data.forEach(item => {
                const stockStatus = item.stock < 5 ? 'tag-low' : 'tag-ok';
                
                // 1. Render PC Row
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="font-weight: bold; color: var(--primary);">${item.name}</td>
                    <td>${item.spec}</td>
                    <td><span style="color: var(--accent);"><i class="fa-solid fa-box"></i> ${item.loc}</span></td>
                    <td><span class="tag ${stockStatus}">${item.stock} Units</span></td>
                    <td>
                        <button class="btn-icon" onclick="updateStock(${item.id})"><i class="fa-solid fa-pen-to-square"></i></button>
                        <button class="btn-icon" style="color: var(--danger)" onclick="deleteItem(${item.id})"><i class="fa-solid fa-trash"></i></button>
                    </td>
                `;
                pcBody.appendChild(tr);

                // 2. Render Mobile Card
                const card = document.createElement('div');
                card.className = 'inventory-card';
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-title">${item.name}</div>
                        <span class="tag ${stockStatus}">${item.stock}</span>
                    </div>
                    <div class="card-spec">${item.spec}</div>
                    <div class="card-details">
                        <span><i class="fa-solid fa-location-dot"></i> ${item.loc}</span>
                        <span>ID: #${item.id.toString().slice(-4)}</span>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button class="btn-main" style="flex:1; padding: 0.5rem;" onclick="updateStock(${item.id})">Edit</button>
                        <button class="btn-main" style="flex:1; background: rgba(239,68,68,0.2); border:1px solid var(--danger); color: var(--danger);" onclick="deleteItem(${item.id})">Del</button>
                    </div>
                `;
                mobileContainer.appendChild(card);
            });
        }

        // === FEATURES ===

        // 1. Search (Filters both views instantly)
        function handleSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            const filtered = inventory.filter(item => 
                item.name.toLowerCase().includes(query) || 
                item.spec.toLowerCase().includes(query) ||
                item.loc.toLowerCase().includes(query)
            );
            refreshUI(filtered);
        }

        // 2. Add Item
        function handleAddItem(e) {
            e.preventDefault();
            const newItem = {
                id: Date.now(),
                name: document.getElementById('inName').value,
                spec: document.getElementById('inSpec').value,
                loc: document.getElementById('inLoc').value,
                stock: parseInt(document.getElementById('inStock').value)
            };
            
            inventory.unshift(newItem); // Add to top
            saveData();
            addLog(`ADDED ITEM`, `${newItem.name} (${newItem.stock})`);
            closeModal('addModal');
            e.target.reset();
            refreshUI();
        }

        // 3. Edit Stock
        function updateStock(id) {
            const item = inventory.find(i => i.id === id);
            if(!item) return;

            const newStock = prompt(`Update Stock Level for ${item.name}:`, item.stock);
            if(newStock !== null && !isNaN(newStock)) {
                const oldVal = item.stock;
                item.stock = parseInt(newStock);
                saveData();
                addLog(`STOCK UPDATE`, `${item.name}: ${oldVal} -> ${item.stock}`);
                refreshUI(); // Re-render to update badges
            }
        }

        // 4. Delete
        function deleteItem(id) {
            if(confirm("Confirm deletion? This cannot be undone.")) {
                const item = inventory.find(i => i.id === id);
                inventory = inventory.filter(i => i.id !== id);
                saveData();
                addLog(`DELETED`, `${item.name} from ${item.loc}`);
                refreshUI();
            }
        }

        // 5. Settings & API Storage
        function saveSettings() {
            config.apiUrl = document.getElementById('apiUrl').value;
            config.apiKey = document.getElementById('apiKey').value;
            config.autoSync = document.getElementById('autoSync').checked;
            
            localStorage.setItem('electro_config', JSON.stringify(config));
            alert("Configuration Saved Successfully!");
            closeModal('settingsModal');
        }

        // === SYSTEM UTILITIES ===
        function saveData() {
            localStorage.setItem('electro_inventory', JSON.stringify(inventory));
        }

        function addLog(action, details) {
            const timestamp = new Date().toLocaleTimeString();
            logs.unshift({ action, details, time: timestamp });
            if(logs.length > 50) logs.pop(); // Keep last 50
            localStorage.setItem('electro_logs', JSON.stringify(logs));
        }

        function openHistory() {
            const list = document.getElementById('logList');
            list.innerHTML = logs.map(l => `
                <li style="padding: 10px; border-bottom: 1px solid #334155; display: flex; justify-content: space-between;">
                    <div>
                        <strong style="color: var(--accent)">${l.action}</strong>
                        <div style="font-size: 0.9em; color: var(--text-sub)">${l.details}</div>
                    </div>
                    <span style="font-size: 0.8em; color: var(--text-sub)">${l.time}</span>
                </li>
            `).join('');
            openModal('historyModal');
        }

        function openModal(id) { document.getElementById(id).classList.add('active'); }
        function closeModal(id) { document.getElementById(id).classList.remove('active'); }

    </script>
</body>
</html>
